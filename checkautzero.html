<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Checkout | Zero Lifestyle</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Outfit:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg-body: #050505;
            --bg-card: #0f0f0f;
            --accent: #00ffcc;
            --accent-glow: rgba(0, 255, 204, 0.2);
            --text-main: #ffffff;
            --text-dim: #94a3b8;
            --border: rgba(255, 255, 255, 0.08);
            --input-bg: #151518;
            --danger: #ff4b4b;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
        }

        .checkout-container {
            max-width: 1200px;
            margin: 40px auto;
            display: grid;
            grid-template-columns: 1.4fr 1fr;
            gap: 30px;
        }

        .section-card {
            background: var(--bg-card);
            padding: 30px;
            border-radius: 16px;
            border: 1px solid var(--border);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            margin-bottom: 25px;
        }

        h2 { font-family: 'Outfit', sans-serif; margin-bottom: 25px; font-size: 1.4rem; color: var(--accent); display: flex; align-items: center; gap: 10px; }

        .form-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 25px; 
        }

        .full-width { grid-column: 1 / -1; }

        .form-group { margin-bottom: 5px; }

        label { 
            display: block; 
            margin-bottom: 8px; 
            color: var(--text-dim); 
            font-size: 0.85rem; 
            text-transform: uppercase; 
            letter-spacing: 1px; 
        }

        input, select {
            width: 100%;
            padding: 14px;
            background: var(--input-bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: white;
            outline: none;
            transition: all 0.3s;
            box-sizing: border-box;
        }

        input:focus { border-color: var(--accent); box-shadow: 0 0 10px var(--accent-glow); }

        /* Order Summary Items */
        .order-summary-item {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
            position: relative;
        }

        .order-summary-item img { width: 70px; height: 70px; border-radius: 10px; object-fit: cover; background: #222; }
        .item-info { flex: 1; }
        .remove-btn {
            background: none;
            border: none;
            color: var(--danger);
            cursor: pointer;
            font-size: 0.8rem;
            padding: 5px 0;
            transition: 0.3s;
        }
        .remove-btn:hover { text-decoration: underline; opacity: 0.8; }

        /* Payment Icons */
        .payment-methods { display: flex; gap: 10px; margin-bottom: 20px; }
        .method-icon { 
            flex: 1; text-align: center; padding: 15px; border: 1px solid var(--border); 
            border-radius: 8px; cursor: pointer; color: var(--text-dim);
            transition: 0.3s;
        }
        .method-icon.active { border-color: var(--accent); color: var(--accent); background: var(--accent-glow); }

        .total-box { margin-top: 20px; background: rgba(255,255,255,0.03); padding: 20px; border-radius: 12px; }
        .price-row { display: flex; justify-content: space-between; margin-bottom: 12px; }
        .grand-total { border-top: 1px solid var(--border); padding-top: 15px; font-weight: 700; color: var(--accent); font-size: 1.3rem; }

        .place-order-btn {
            width: 100%;
            padding: 18px;
            background: var(--accent);
            color: #000;
            border: none;
            border-radius: 8px;
            font-weight: 800;
            cursor: pointer;
            text-transform: uppercase;
            font-family: 'Outfit', sans-serif;
            margin-top: 20px;
            transition: 0.3s;
        }

        .place-order-btn:hover { transform: translateY(-3px); box-shadow: 0 10px 20px var(--accent-glow); }

        @media (max-width: 900px) { .checkout-container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <form id="checkoutForm" onsubmit="event.preventDefault(); handleOrder();">
        <div class="checkout-container">
            <main>
                <div class="section-card">
                    <h2><i class="fa-solid fa-truck-fast"></i> Shipping Details</h2>
                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label>Full Name</label>
                            <input type="text" placeholder="Name" required>
                        </div>
                        <div class="form-group">
                            <label>Email Address</label>
                            <input type="email" placeholder="Example@gmail.com" required>
                        </div>
                        <div class="form-group">
                            <label>Phone Number</label>
                            <input type="tel" placeholder="3339255881" required>
                        </div>
                        <div class="form-group full-width">
                            <label>Shipping Address</label>
                            <input type="text" placeholder="House #, Street name, Sector/Area" required>
                        </div>
                    </div>
                </div>

                <div class="section-card">
                    <h2><i class="fa-solid fa-credit-card"></i> Payment Method</h2>
                    <div class="payment-methods">
                        <div class="method-icon active" onclick="togglePayment('card')">
                            <i class="fa-solid fa-credit-card"></i><br><small>Card</small>
                        </div>
                        <div class="method-icon" onclick="togglePayment('cod')">
                            <i class="fa-solid fa-hand-holding-dollar"></i><br><small>Cash on Delivery</small>
                        </div>
                    </div>

                    <div id="cardDetails" class="form-grid">
                        <div class="form-group full-width">
                            <label>Card Number</label>
                            <input type="text" id="cardNumber" placeholder="xxxx xxxx xxxx xxxx">
                        </div>
                        <div class="form-group">
                            <label>Expiry Date</label>
                            <input type="text" placeholder="MM / YY">
                        </div>
                        <div class="form-group">
                            <label>CVV</label>
                            <input type="password" placeholder="123">
                        </div>
                    </div>
                    
                    <div id="codMessage" style="display:none; color: var(--text-dim); padding: 15px; background: rgba(255,255,255,0.05); border-radius: 8px; line-height: 1.5;">
                        <i class="fa-solid fa-circle-info" style="color: var(--accent)"></i> 
                        Pay with cash upon delivery. Please keep the exact amount ready. Extra Rs. 50 may apply for handling.
                    </div>
                </div>
            </main>

            <aside>
                <div class="section-card">
                    <h2>Order Summary</h2>
                    <div id="orderItems">
                        </div>
                    
                    <div class="total-box">
                        <div class="price-row"><span>Subtotal</span><span id="subtotal">Rs. 0</span></div>
                        <div class="price-row"><span>Shipping</span><span style="color: var(--accent);">FREE</span></div>
                        <div class="price-row"><span>Sales Tax</span><span>Rs. 250</span></div>
                        <div class="price-row grand-total">
                            <span>Total</span>
                            <span id="grandtotal">Rs. 0</span>
                        </div>
                    </div>

                    <button type="submit" class="place-order-btn">Complete Purchase</button>
                </div>
            </aside>
        </div>
    </form>

    <script>
        function loadCart() {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            let container = document.getElementById("orderItems");
            let subtotal = 0;
            
            if(cart.length === 0) {
                container.innerHTML = `<p style="color:var(--text-dim); text-align:center; padding: 20px;">Your cart is empty</p>`;
                updatePrices(0);
                return;
            }

            container.innerHTML = "";
            cart.forEach((item, index) => {
                subtotal += item.price * (item.qty || 1);
                container.innerHTML += `
                    <div class="order-summary-item">
                        <img src="${item.image}" alt="${item.name}">
                        <div class="item-info">
                            <p style="margin:0; font-weight:600;">${item.name}</p>
                            <p style="margin:5px 0; font-size:0.85rem; color:var(--text-dim)">Qty: ${item.qty || 1} Ã— Rs. ${item.price.toLocaleString()}</p>
                            <button class="remove-btn" onclick="removeItem(${index})"><i class="fa-solid fa-trash-can"></i> Remove</button>
                        </div>
                    </div>`;
            });

            updatePrices(subtotal);
        }

        function updatePrices(subtotal) {
            document.getElementById("subtotal").innerText = "Rs. " + subtotal.toLocaleString();
            let total = subtotal > 0 ? subtotal + 250 : 0;
            document.getElementById("grandtotal").innerText = "Rs. " + total.toLocaleString();
        }

        function removeItem(index) {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            cart.splice(index, 1);
            localStorage.setItem("cart", JSON.stringify(cart));
            loadCart();
        }

        function togglePayment(type) {
            const cardDetails = document.getElementById('cardDetails');
            const codMessage = document.getElementById('codMessage');
            const icons = document.querySelectorAll('.method-icon');
            const cardInputs = cardDetails.querySelectorAll('input');

            icons.forEach(icon => icon.classList.remove('active'));
            
            if(type === 'card') {
                cardDetails.style.display = 'grid';
                codMessage.style.display = 'none';
                icons[0].classList.add('active');
                cardInputs.forEach(input => input.required = true);
            } else {
                cardDetails.style.display = 'none';
                codMessage.style.display = 'block';
                icons[1].classList.add('active');
                cardInputs.forEach(input => input.required = false);
            }
        }

        // Auto-space Card Number
        document.getElementById('cardNumber').addEventListener('input', function (e) {
            e.target.value = e.target.value.replace(/[^\d]/g, '').replace(/(.{4})/g, '$1 ').trim();
        });

        function handleOrder() {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            if(cart.length === 0) {
                alert("Your cart is empty!");
                return;
            }
            
            // Clear cart and redirect
            localStorage.removeItem("cart");
            window.location.href = "thankzero.html";
        }

        // Initial Load
        loadCart();
        // Set initial required state for card
        togglePayment('card');
    </script>
</body>
</html>